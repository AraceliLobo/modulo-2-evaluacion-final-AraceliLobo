"use strict";const inputSearch=document.querySelector(".js-search"),seriesList=document.querySelector(".js-seriesList"),favList=document.querySelector(".js-favList"),btnSearch=document.querySelector(".js-btnSsearch"),btnRemove=document.querySelector(".js-btnRemoveAll");let shows=[],favorites=[];function getShows(e){e.preventDefault();const s=inputSearch.value;fetch("https://api.tvmaze.com/search/shows?q="+s).then((function(e){return e.json()})).then((function(e){shows=e,paintSeries(),listenSeries(),addFavorites(),listenFavorites()}))}function paintSeries(){let e="";for(let s=0;s<shows.length;s++){let t="fav-item";t=-1!==favorites.findIndex((function(e,t){return e.id===shows[s].show.id}))?"fav-item":"",e+=`<li class="serie-item js-item ${t}" id="${shows[s].show.id}">`,e+=`<h3 class= "serie-name js-name">${shows[s].show.name}</h3>`,null===shows[s].show.image?e+='<img class="serie-image js-image" src="./assets/images/noimage.png"/>':(e+=`<img class="serie-image js-image" src="${shows[s].show.image.medium}"/>`,e+="</li>")}seriesList.innerHTML=e,listenFavorites()}function favoritesSeries(e){const s=parseInt(e.currentTarget.id),t=favorites.findIndex((function(e,t){return e.id===s}));if(!0===(-1!==t))favorites.splice(t,1);else for(let e=0;e<shows.length;e++)shows[e].show.id===s&&favorites.push(shows[e].show);paintSeries(),listenSeries(),addFavorites(),setLocalStorage()}function listenSeries(){const e=document.querySelectorAll(".js-item");for(const s of e)s.addEventListener("click",favoritesSeries)}function addFavorites(){let e="";for(let s=0;s<favorites.length;s++)e+=`<li class="fav-item" id="${favorites[s].id}">`,e+=`<h3 class="fav-name">${favorites[s].name}</h3>`,null===favorites[s].image?e+='<img class="fav-image" src="./assets/images/noimage.png"/>':e+=`<img class="fav-image" src="${favorites[s].image.medium}"/>`,e+="</li>";favList.innerHTML=e,listenFavorites()}function listenFavorites(){const e=document.querySelectorAll(".js-favorite-item");for(const s of e)s.addEventListener("click",removeAll)}btnSearch.addEventListener("click",getShows),listenFavorites();const setLocalStorage=()=>{const e=JSON.stringify(favorites);localStorage.setItem("fav",e)},getLocalStorage=()=>{const e=localStorage.getItem("fav");null!==e&&(favorites=JSON.parse(e),addFavorites())};function removeAll(){favorites=[],localStorage.removeItem("fav"),addFavorites(),paintSeries(),listenSeries(),listenFavorites()}getLocalStorage(),btnSearch.addEventListener("click",getShows),btnRemove.addEventListener("click",removeAll);